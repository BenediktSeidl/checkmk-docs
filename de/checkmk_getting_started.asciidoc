include::global_attr.adoc[]
= Schnelleinstieg ins Monitoring
:revdate: draft
:title: Schnelleinstieg ins Monitoring
:description: Die ersten Schritte in {CMK} sind schnell getan. Nach der Installation braucht es nur 3 Schritte, um den ersten Host zu überwachen.

{related-start}
link:intro_welcome.html[Leitfaden für Einsteiger]
link:install_packages.html[Grundsätzliches zur Installation von {CMK}]
link:monitoring_basics.html[Grundlagen des Monitorings mit {CMK}]
{related-end}


// TK: Nun auch mit Docker (fehlte bisher). Docker spezifische Info bitte kritisch überprüfen.
Sie haben {CMK} auf einem xref:install_packages#[Linux-Server] installiert.
Dann haben Sie eine xref:intro_setup#create_site[Monitoring-Instanz (_site_) erstellt] und die xref:intro_setup#start_site[Instanz gestartet].
Ihre Instanz ist jetzt bereit, mit Leben gefüllt zu werden.
Hier erfahren Sie, wie Sie die ersten Geräte in das Monitoring aufnehmen können.

Falls Sie {CMK} statt auf einem Linux-Server mit einer unserer Appliances oder im Docker-Container betreiben, läuft die Software-Installation und die Instanzverwaltung im Detail etwas anders ab:
Für die virtuelle Appliance wird die xref:introduction_virt1#[Installation] und das xref:appliance_usage#site_management[Anlegen einer Instanz] in eigenen Artikeln beschrieben.
Bei der xref:introduction_docker#[Installation als Docker-Container] wird die Instanz `cmk` gleich mit eingerichtet und gestartet.
//SK: Das hier wäre wieder so ein Beispiel für einen "Kasten". Irgendwie stört dieser Abschnitt hier nämlich, weil vorher bereits gesagt wurde, dass man ja schon alles installiert hat. Dann kommt der Satz "Falls Sie Checmk statt auf einem Linux-Server [...] läuft [...]". Ich finde diesen Absatz sehr holprig und unerwartet.

*Tipp:* Wenn Sie mal nicht weiter wissen, hoffen wir, dass Sie die Antwort auf Ihre Frage in diesem Handbuch finden. Bei Fragen zu Details der {CMK}-Oberfläche können Sie sich aber auch die kontext-sensitive Online-Hilfe einblenden: auf der Hauptseite im [.guihint]#Help#-Menü mit [.guihint]#Help > Show inline help#.
//SK: Show inline help ist im Main dashboard - also an der Stelle, die man nach dem ersten Login als erstes erreicht - leider ausgegraut. Eigentlich ein guter Hinweis, aber an dieser Stelle könnte er gleich zum ersten Misserfolg führen. Und eingeloggt bin ich ja auch eigentlich noch gar nicht.


[#login]
== An der Web-GUI anmelden

Wenn Ihr {CMK}-Server `myserver` heißt und Ihre Instanz `mysite`, erfolgt der Zugriff auf die Web-GUI mit `\http://myserver/mysite/` im Browser:

image::login.png[width=60%]

Beim Erstellen der Instanz wurde auch der administrative {CMK}-Benutzer `cmkadmin` mit einem zufällig generierten Passwort angelegt, das Sie sich notiert oder auch gleich geändert haben.
//SK: Das Notieren des Passworts sollte villeicht noch in irgendeinem Artikel erwähnt werden. Wie ich hörte wird dieser Artikel "Ersteinrichtung" heißen.

Im Docker-Container heißt der Benutzer ebenfalls `cmkadmin`.
Sein Passwort steht in den xref:introduction_docker#login[Log-Dateien des Containers].
Bei Verwendung der Appliance haben Sie Benutzername und Passwort beim Erzeugen der Instanz selbst festgelegt.


[#install_agent]
== Agent auf dem Monitoring-Server installieren

Als ersten Host nehmen Sie den Monitoring-Server selbst in die Überwachung auf.
Dazu benötigen Sie erst einmal einen Monitoring-Agenten.

Auf den Appliances ist dieser _{CMK}-Agent_ bereits vorinstalliert.

Wenn Sie mit einem eigenen Linux-Server oder im Docker-Container arbeiten, müssen Sie den Agenten installieren. Sie starten in der Navigationsleiste mit dem [.guihint]#Setup#-Menü.

In den {CEE} gelangen Sie mit [.guihint]#Setup > Agents > Windows, Linux, Solaris, AIX# zur Download-Seite, die Ihnen einen generischen Agenten anbietet, den Sie sofort herunterladen können:

image::agent_download_cee.png[]

In der {CRE} kommen Sie über [.guihint]#Setup > Agents > Linux# zu einer ähnlich aufgebauten Download-Seite.

// TK: Das TGZ-Paket wird nicht mehr erwähnt, da die Installation des Servers auch nur für RPM und DEB unterstützt und beschrieben wird.
Laden Sie die Paketdatei herunter:
Wählen Sie das RPM-Dateiformat für Red Hat, CentOS und SLES oder das DEB-Dateiformat für Debian und Ubuntu.
Installieren Sie das Paket anschließend auf Ihrem {CMK}-Server.
Dies geht je nach Linux-Distribution mit `yum install` (Red Hat, CentOS), `zypper install` (SLES) oder `apt install` (Debian, Ubuntu). Eine ausführliche Anleitung zur Installation des Agenten finden Sie im xref:intro_setup_monitor#install_agent[Leitfaden für Einsteiger].
//SK: Die Installation des Agenten per apt install in tatsächlich möglich. Allerdings beschreiben wir das sonst überall mit dpkg -i und ich würde vorerst dabei bleiben, weil ich glaube, dass sich die Installation per apt noch nicht etabliert ist. Außerdem gibt hier noch den Fallstrick, dass nach apt install unbedingt der vollständige Pfad zum .deb-Paket angegeben werden muss.

*Tipp:* Um für einen Docker-Container spezifische Informationen zu erhalten, ist zusätzlich zum Linux-Agenten die xref:monitoring_docker#install_agent_plugin[Installation des Agentenplugins] `mk_docker.py` notwendig.
//SK: Dieser Tipp verwirrt m.E. mehr als das er hilft. Das Plugin mk_docker.py sollte auf Docker Hosts installiert werden, um Informationen über die - auf diesem Host - laufenden Container zu sammeln. Auf mich wirkt dieser Tipp so, als müsste man das Plugin in dem Container (bspw. dem Checkmk-Docker-Container) installieren. Das brächte aber genau gar nichts.

[#add_server]
== Server ins Monitoring aufnehmen

Die Verwaltung der zu überwachenden Hosts finden Sie wieder im [.guihint]#Setup#-Menü, genauer unter [.guihint]#Setup > Hosts > Hosts#.

Klicken Sie auf [.guihint]#Add host#, tragen Sie als [.guihint]#Hostname# 
`localhost` ein und klicken Sie auf [.guihint]#Save &amp; go to service configuration#:

image::checkmk_getting_started_services_undecided.png[]
//SK: Passend zu dem folgenden sollte noch ein roter Rand um den Knopf "Fix all".

In dieser Liste fügen Sie alle gefundenen, aber noch nicht überwachten Services (_undecided_) per Knopfdruck auf [.guihint]#Monitor undecided services# oder [.guihint]#Fix all# dem Monitoring hinzu.
// SK: Ich würde hier den Fokus auf "Fix all" legen. Wer hier "Monitor undecided services" wählt und dem fehlt ggf. das Label "cmk/check_mk_server:yes". Das gibt später nur Probleme. Best practive ist für mich hier auf jeden Fall "Fix all" und "Monitor undecided" kann irgendwo anders - aber nicht im Schnelleinstieg - beschrieben werden.

Klicken Sie anschließend rechts oben auf der Hauptseite auf den orangen Knopf [.guihint]#3 changes#, um auf der darauf folgenden Seite mit [.guihint]#Activate on selected sites# die Änderungen zu aktivieren. 
Damit wird der neue Host mit seinen Services aus der Konfigurationsumgebung in die Monitoring-Umgebung übernommen.
// SK: Ich hab hier mal die 2 durch eine 3 ersetzt. Bei einem (neuen) Checkmk-Server sollte es hier auf jeden Fall 3 changes geben. 1. Neuer Host 2. neue Labels 3. neue Check configuration (Services)

Das war auch schon alles!

Der Server wird mit Standardeinstellungen überwacht, was Sie sehen können, wenn sie sich im [.guihint]#Monitor#-Menü alle Hosts anzeigen lassen mit [.guihint]#Monitor > Overview > All hosts# und dann den neuen [.guihint]#localhost# auswählen:

image::checkmk_getting_started_services.png[]


[#add_more]
== Weitere Server und Netzwerkgeräte aufnehmen

Auf die gleiche Art können Sie weitere Geräte in das Monitoring aufnehmen. Dazu noch ein paar Hinweise:

* Zur Überwachung von xref:agent_windows#[Windows] nutzen Sie den Agenten im MSI-Paket. Der Windows-Agent installiert unter Windows den Dienst „Check MK Service“.

* Zur Überwachung von xref:snmp#[SNMP-Geräten] wie Router, Switches, Drucker oder Hardwaresensoren nutzen Sie die bereits vom Hersteller eingebaute Schnittstelle für das Monitoring: den SNMP-Agenten. Beim Einrichten des Hosts für ein SNMP-Gerät wählen Sie daher bei [.guihint]#Checkmk agent# die Option [.guihint]#No agent# und stattdessen bei [.guihint]#SNMP# den Eintrag [.guihint]#SNMP v2 or v3#. Falls die SNMP Community nicht `public` lautet, dann tragen Sie diese unter [.guihint]#SNMP credentials# ein.

* Wenn der Host-Name nicht per DNS auflösbar ist, dann aktivieren Sie in den Eigenschaften des Hosts den Parameter [.guihint]#IPv4 address# und tragen die IP-Adresse manuell ein.
