include::global_attr.adoc[]
= Berichte (Reports)
:revdate: 2021-11-22
:title: Berichte (Reports)
:description: {CMK} kann Berichte (Reports) nicht nur automatisiert/ad hoc erstellen, sondern diese auch direkt verschicken. Lernen Sie hier, wie Sie diese Funktion nutzen.

{related-start}
link:views.html[Ansichten von Hosts und Services (Views)]
link:graphing.html[Messwerte und Graphing]
link:dashboards.html[Dashboards]
{related-end}

// ML: Aktualisiert auf 2.0, sollte aber bei Gelegenheit komplett überarbeitet werden.

== Was sind Berichte?

Ein Bericht in {CMK} ist eine Zusammenstellung unterschiedlicher
Elemente (link:views.html[Ansichten], link:availability.html[Verfügbarkeitstabellen],
link:graphing.html[Verlaufsgraphen], Fließtext,
Logos) zu einem druckfähigen PDF-Dokument.

=== Kennzeichen von Berichten

* Es sind keine externen Werkzeuge wie Jasper, DB oder Ähnliches notwendig.
* Die PDF-Datei wird sauber mit Vektorgrafiken gerendert.
* Berichte können über Schablonen und Vererbung verwaltet werden.
* xref:reporting#scheduler[Der Berichtsplaner] verschickt auf Wunsch periodisch Berichte.
* Sofortberichte werden über [.guihint]#Export > This view as PDF# erzeugt.

.Ansichten können jederzeit als PDF exportiert werden
image::reporting_menu_export.png[alt="Aufgeklapptes Export-Menü mit Optionen."]

{cee-only}
Den Menüpunkt [.guihint]#This view as PDF# finden Sie in allen Ansichten, falls Sie
einer der {CEE} einsetzen.

== Berichte-Element für die Seitenleiste
Über das Seiteleistenelement [.guihint]#Reporting# in der Seitenleiste  erhalten Sie raschen
Zugriff auf alle Berichte und den link:reporting.html#scheduler[Berichtsplaner.]

.Den Schnellzugriff können Sie der Seitenleiste hinzufügen
image::reporting_sidebar.png[alt="Seiteleistenelement des Reportings.",width=55%]

In diesem Element befinden sich drei Knöpfe:

[cols=2]
|===

|[.guihint]#Change Timerange# |Verändert Zeitfenster für Sofortberichte.
|[.guihint]#Scheduler# |Öffnet den Berichtsplaner.
|[.guihint]#Edit# |Öffnet die Liste vorhandener Berichte.
|===


== Globale Vorgaben für Berichte

Die globalen Voreinstellungen für Berichte konfigurieren Sie über [.guihint]#WATO > Global Settings > Reporting.#

.Einstellungen wie Vorlagen und Schriftgrößen können Sie global festlegen
image::reporting_global_settings.png[alt="Globale Einstellungen des Reportings."]

== Vorhandene Berichte anpassen

Wie bei link:views.html[Ansichten] und link:dashboards.html[Übersichten] ist es nicht möglich, mitgelieferte
Berichte zu verändern. Sie müssen einen bereits vorhandenen Bericht
klonen. Dieser Klon kann von Ihnen beliebig angepasst werden.

Zur Liste aller Berichte gelangen Sie über [.guihint]#Customize > Reports:#

.Einige der bereits integrierten Berichte
image::reporting_list.png[alt="Liste mit Berichten."]

Auf der linken Seite stehen folgende Symbole für die Bearbeitung zur
Verfügung:

[cols=2]
|===

|icon:icon_clone[] |Bericht kopieren
|icon:icon_pdf[] |Vorschau anzeigen
|icon:icon_reportscheduler[] |Regelmäßigen Bericht planen
|===


=== Grundeinstellungen

Wenn Sie das Symbol icon:icon_clone[alt=] Klonen anklicken, wird der Bericht geklont und Sie gelangen zur
Bearbeitung der Grundeinstellungen für den neuen Bericht:

.Geklonter Bericht [.guihint]#Report of host#
image::reporting_general_properties.png[alt="Eingabemaske für allgemeine Einstellungen eines Reports."]

Tragen Sie mindestens Werte für [.guihint]#Unique ID# und [.guihint]#Title# ein. Wenn Sie den Bericht für andere
Benutzer verfügbar machen möchten, aktivieren Sie die Option 
[.guihint]#Make this report available for other users.#
Sie können den Bericht dann für alle Nutzer oder nur für Mitglieder bestimmter Kontaktgruppen freigeben.
Wenn der Bericht nicht in der
Hauptnavigation zur Auswahl angeboten werden soll, verwenden Sie Option
[.guihint]#Hide this report in the monitor menu.#

Wechseln Sie in den Abschnitt [.guihint]#Report Properties#. An dieser Stelle
konfigurieren Sie Werte für Schrift, Seitenformat, Zeit- und
Datumseinstellungen, das Berichtslayout und den Dateinamen bei Downloads.

.An dieser Stelle können Sie grundlegende CI-Richtlinien vorgeben
image::reporting_report_properties.png[alt="Eingabemaske für Layout-Voreinstellungen eines Berichts."]

Im darauffolgenden letzten Abschnitt [.guihint]#Context / Search Filters# stehen Ihnen wie üblich umfangreiche Filtermöglichkeiten zur Verfügung, von bestimmten Hosts, über einzelne Docker-Container, bis hin zu Werten aus der Oracle-Überwachung.

Wenn alle Werte für Sie passend definiert sind, fahren Sie über einen der Punkte im Menü [.guihint]#Report > Save this report and go to# fort:
[cols="30,~"]
|===

|[.guihint]#List of reports# |Konfiguration speichern und zurück zur Berichtsliste
|[.guihint]#Elements# |Konfiguration speichern und weiter zur Konfiguration der Berichtselemente
|[.guihint]#Generate# |Konfiguration speichern und Bericht sofort erstellen
|===


Nach dem Speichern wird Ihr Bericht in der Liste angezeigt.

.Kopierte Berichte können natürlich auch geändert und gelöscht werden
image::reporting_list_cloned.png[alt="Listeneintrag eines geklonten Berichts."]

Für die Bearbeitung eigener Berichte können Sie auf folgende Funktionen zurückgreifen:

[cols=2]
|===

|icon:icon_clone[] |Bericht kopieren
|icon:icon_delete[] |Bericht löschen
|icon:icon_edit[] |Berichtseinstellungen bearbeiten
|icon:button_report_element_lo[] |Berichtsinhalte bearbeiten
|icon:icon_pdf[] |Vorschau anzeigen
|icon:icon_reportscheduler[] |Regelmäßigen Bericht planen
|===


=== Berichtselemente

Mit Anklicken des Symbols icon:button_report_element_lo[] öffnen Sie die Übersicht für den ausgewählten Bericht.

.Vorschau mit Fehlermeldungen wegen fehlendem Kontexts
image::reporting_content_overview.png[alt="Vorschau und Übersicht eines Berichts."]

Auf der linken Seite sehen Sie die Vorschau, hier für den Bericht von [.guihint]#Host.#
Rechts daneben werden die Elemente des Berichts in einer Liste angezeigt.
Diese Elemente werden mit den eingeblendeten Symbolen icon:icon_edit[] bearbeitet, icon:icon_clone[] kopiert, icon:icon_delete[] gelöscht und icon:icon_drag[] umsortiert.

Tipp: In der Vorschau sehen Sie rote Zeilen und Fehlermeldungen statt echter Daten -- denn natürlich fehlt dem Bericht im Editor der Kontext, hier also etwa die Angabe eines Hosts, der sich erst über den Aufruf des Berichts aus einer entsprechenden Ansicht ergeben würde.
Wenn Sie vernünftige Vorschauen sehen wollen, filtern Sie einfach in den Berichtseinstellungen im Bereich [.guihint]#Context / Search Filters# zwischenzeitlich auf einen bestimmten Host, das macht das Gestalten deutlich einfacher.

.Vorschau mit echten Daten eines gefilterten Hosts
image::reporting_content_overview_filtered.png[alt="Berichtsvorschau mit echten Daten."]

Neue Elemente fügen Sie über die beiden Knöpfe [.guihint]#Add content# und 
[.guihint]#Add page element# in den Bericht ein.
Letzteres sind reine Gestaltungselemente für Seiten: Horizontale Linie, Bild, Seitenrahmen und eine einzelne Textzeile.
Diese Bausteine können Sie auf allen oder bestimmten Seiten Ihres Berichts anzeigen lassen.

Den eigentlichen Inhalt fügen Sie über [.guihint]#Add content# hinzu, also beispielsweise Tabellen, Graphen, Inhaltsverzeichnisse oder Texte (auch via Makros oder HTTP).
Diese Inhalte erscheinen nacheinander und bestimmen so auch die finale Länge des Berichts.

// ML: Hier sollte bei Gelegenheit noch eine ausführliche Tabelle nachgetragen werden.

.Auszug der Inhaltsbausteine für Berichte
image::reporting_content_elements.png[alt="Auszug der Elemente für einen Bericht."]


=== Bild einfügen

Bilder, die Sie in Ihren Berichten als Gestaltungselemente verwenden möchten, müssen im Verzeichnis `local/share/check_mk/reporting/images` vorhanden sein.

Klicken Sie auf den Knopf [.guihint]#Add page element#. Wählen Sie als Typ 
[.guihint]#Embedded image# und setzen über [.guihint]#Continue# fort.

.Hier werden Bilder als Gestaltungselement eingefügt _(fixed page element)_
image::reporting_image_add.png[alt="Eingabemaske zum Einfügen eines Bilds."]

In den folgenden Dialogen werden Detaileinstellungen wie Position, Dateiname und Größe gesetzt.

.Größenangaben in Millimetern für einfache Druckgestaltung
image::reporting_image_properties.png[alt="Eingabemaske für Bildeigenschaften."]

Wenn Sie mit allen Einstellungen fertig sind, speichern Sie über 
[.guihint]#Save.# Danach gelangen Sie in die Berichtsübersicht und sehen das
eingefügte Bild in der Berichtsvorschau.

=== Logo des Berichts verändern

Kopieren Sie Ihr Firmenlogo in das Verzeichnis
`local/share/check_mk/reporting/images` und speichern Sie es als Datei
`logo_mk.png`. Ab sofort wird dieses Logo auf allen Berichten
angezeigt.

[#create_reports]
== Neue Berichte erstellen

Einen neuen Bericht legen Sie über [.guihint]#Customize > Reports > Add report# an.
Im ersten Schritt können Sie einen Filter setzen und den Bericht von vornherein auf einen bestimmten Host oder eine bestimmte Datenquelle beschränken, etwa Netzwerkschnittstellen, BI-Aggregate, Sensoren und so weiter.
In der Regel werden Sie die Vorgabe [.guihint]#No restrictions to specific objects# verwenden können.

.Meist werden Sie die Filter auf dieser Ebene nicht benötigen
image::reporting_new.png[alt="Liste mit Filtern für die Beschränkung des Berichts."]

Anschließend kommt nur noch, was Sie bereits kennen -- die weitere Anpassung des Berichts entspricht der oben gezeigten Bearbeitung bestehender Berichte.

[#views]
== Ansichten und Verlaufsgraphen in Berichte einfügen

Wenn Sie nun einen Verlaufsgraphen oder eine tabellarische Ansicht in einen Ihrer Berichte aufnehmen wollen, rufen Sie einfach die gewünschte Ansicht auf und filtern Sie gegebenenfalls auf die gewünschten Ergebnisse.
Anschließend müssen Sie nur noch Ihren Bericht über das Menü [.guihint]#Export# aufrufen und schon landen Sie direkt im PDF.

.Eigene Berichte landen auch im Export-Menü -- sofern nicht explizit ausgeschlossen
image::reporting_exportmenu.png[alt="Export-Menü mit eigenen Berichten."]

[#scheduler]
== Der Berichtsplaner

Über den Berichtsplaner können Sie vorhandene Berichte automatisiert erstellen und versenden lassen.
Sie erreichen den den Planer über [.guihint]#Customize > Reports > Reports > Scheduler.#

Im Abschnitt [.guihint]#General Options# legen Sie Grundeinstellungen wie Titel,
Erstellungszeit, Berichtszeitraum, Empfänger und so weiter fest.

.Sie können sich zum Beispiel automatisch freitagnachmittags einen Wochenbericht per PDF zuschicken lassen
image::reporting_schedule.png[alt="Einstellungen für den automatischen Berichtsplaner."]

Unter [.guihint]#Context / Search Filters# finden Sie anschließend wieder die üblichen Filtermöglichkeiten, abhängig vom gewählten Bericht. Speichern Sie den Bericht anschließend, um zur Liste Ihrer Planung zurückzukehren.

In der Liste finden Sie auch Informationen darüber, wann der Bericht zum letzten
Mal erzeugt/versandt wurde, ob dabei ein Fehler aufgetreten ist und wann er das nächste Mal
erzeugt/versandt wird und einiges mehr (hier leicht gekürzt):

.Geplante Berichte mit ausführlichen, hier leicht gekürzten, Informationen zu Status
image::reporting_schedule_list.png[alt="Liste mit geplanten Berichten."]

Einträge in der Liste werden über die fünf Aktionssymbole am Listenanfang verwaltet:

[cols="20,~"]
|===

|icon:icon_edit[] |Berichtseinstellungen bearbeiten
|icon:icon_clone[] |Berichtseinstellungen kopieren
|icon:icon_delete[] |Geplanten Bericht löschen
|icon:icon_pdf[] |Bericht erzeugen
|icon:icon_pdfpreview[] |Vorschau anzeigen
|===


Versendete Berichte werden nicht in der Instanz gespeichert.


