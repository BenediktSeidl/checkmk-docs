= Alarmierung per Cisco Webex Teams (Notifications)
:revdate: draft
[.seealso][#notifications]:title: Alarmierung per Cisco Webex Teams
###MD:

== Funktion
<a href="https://www.webex.com/team-collaboration.html">Webex Teams</a>
ist eine Anwendung für die kontinuierliche Zusammenarbeit im Team mit
Video-Meetings, Gruppennachrichten und Dateifreigaben der Firma Cisco. Themen
oder Teams werden hierin in sogenannten Bereichen (Spaces) organisiert.
###,um beispielsweise Zugriffrechte zu definieren.
Einen solchen Bereich können Sie auch für den Empfang von Alarmierungen aus
(CMK) nutzen. Für die eigentliche Verbindung muss in Webex Teams noch ein
Webhook erzeugt werden.

== Konfiguration Cisco Webex Teams

Die Vorraussetzung dafür, Alarmierungen aus Checkmk in Webex Teams erhalten zu
können, ist es also, dass mindestens ein Bereich (Space) eingerichtet ist. Dies
lässt sich in wenigen Sekunden erledigen und wird in dem folgenden Artikel der
Webex Hilfe beschrieben:

<a href="https://help.webex.com/de-de/hk71r4/Webex-Teams-Create-a-Space">Webex Teams - Einen Bereich erstellen</a>
### Link zum englischsprachigen Artikel: https://help.webex.com/en-us/hk71r4/Webex-Teams-Create-a-Space

Mindestens für einen ersten Test bietet es sich sicherlich an einen dedizierten
Bereich alleine für Checkmk mit einem entsprechenden Namen einzurichten.

In Webex Teams muss nun noch die App _Incoming Webhooks_ aktiviert bzw.
verbunden werden. Diese finden Sie im
<a href="[https://apphub.webex.com/teams/applications/incoming-webhooks-cisco-systems">Webex App Hub</a>.

###SK: Bin mir hier gerade nicht ganz sicher. Das hier drüber gefällt mir besser, aber da kann man den Link zum App Hub leichter verpeilen.
###SK:Ansonsten halt so:
###In Webex Teams muss nun noch die App _Incoming Webhooks_ aktiviert bzw.
###verbunden werden. Diese App finden Sie über den folgenden Link im Webex App Hub:
###<a href="[https://apphub.webex.com/teams/applications/incoming-webhooks-cisco-systems">https://apphub.webex.com/teams/applications/incoming-webhooks-cisco-systems</a>

Klicken Sie auf dieser Seite auf [.guihints]#Connect}}.# (Sollten Sie mit dem
verwendeten Browser nicht in Webex Teams angemeldet sein, erscheint nun erst der
Anmeldebildschirm von Cisco Webex.)

image::bilder/notifications_webex1.png[]

Nach kurzer Wartezeit sieht es erst mal so aus, als ob sich nicht viel getan
hätte. Wenn Sie jetzt aber an das Ende der Seite scrollen, können Sie über die
Eingabe- und Auswahlfelder sowohl einen Namen für den Webhook festlegen, als
auch den zu verwendenen Bereich in Webex Teams auswählen. Klicken Sie zum Schluß
auf [.guihints]#Add}}.# 

image::bilder/notifications_webex2.png[align=center,width=70%]

Kopieren Sie die so erzeugte Webhook URL nun durch ein Klick auf das
entsprechende Icon.

image::bilder/notifications_webex3.png[align=center,width=70%]

###NL:Rufen Sie in der Gruppenansicht aus dem Hauptmenü den Punkt [.guihints]#Integrations# auf.
###NL:Erstellen Sie einen neuen Webhook über [.guihints]#Incoming Webhooks => AddIncoming Webhook.}}# 
###NL:Vergeben Sie nach Belieben Namen und Beschreibung und wählen Sie den Channel für die Postings mit den Benachrichtigungen.

== Konfiguration Checkmk

Die Aktivierung in Checkmk beschränkt sich auf die Angabe der oben kopierten
Webhook-URL:

. Wählen Sie als [.guihints]#Notification Method# den Punkt [.guihints]#Cisco Webex Teams}}.# 
. Geben die kopierte Webhook-URL an.

image::bilder/notifications_webex4.png[]

Optional dürfen Sie URL-Präfixe angeben, um Links auf Ihre Checkmk-GUI innerhalb
der Benachrichtigung zu steuern. Statt die Webhook-URL hier direkt anzugeben,
können Sie ebenso den Passwortspeicher von WATO heranziehen und die URL aus
einem der Einträge auslesen.

Zum Testen können Sie die [commands|Kommandos] [.guihints]#Fake check results# und
[.guihints]#Custom notification# verwenden. 
