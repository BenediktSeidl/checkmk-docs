[#create_hosts]
= Hosts anlegen in WATO

include::{chapter}[]

Zur Verwaltung der Ordner und Hosts gelangen Sie über das WATO-Modul
icon:icon_folder[] [.guihint]#Hosts#:

[{image-border}]
image::wato_hosts.png[]


Das Anlegen eines neuen Hosts über den Knopf icon:icon_new[],
das icon:icon_insert[] Klonen eines bestehenden Hosts und auch das icon:icon_edit[] Editieren
eines Hosts, bringt Sie zu der Seite mit den _Attributen_ des Hosts. Diese
ist in drei Abschnitte eingeteilt:

== Der Hostname

Am wichtigsten ist der _Hostname_. Dieses Feld dient überall innerhalb
von {CMK} zur _eindeutigen Identifizierung_ des Hosts. Der Hostname
wird in interne Referenzen eingetragen, als Teil von URLs verwendet, dient
als Teil von Dateinamen und Verzeichnissen, taucht in Logdateien auf usw. Es
gibt zwar eine Funktion, um Hostnamen später zu ändern, dies ist aber ein
aufwendiger und komplexer Vorgang, den Sie vermeiden sollten. Wählen Sie
daher den Namen sorgfältig. Der Hostname _muss nicht unbedingt_ mit
dem DNS-Namen des Hosts übereinstimmen, aber es macht etliche Dinge einfacher.

image::new_host_1.png[]

[#dns]
== Alias und IP-Adresse

Sie können unter _Alias_ einen alternativen,
beschreibenden Namen für den Host vergeben, welcher an vielen Stellen in
der GUI und in Berichten angezeigt wird. Vergeben Sie kein Alias, so wird als
Alias der Hostname verwendet.


[{image-border}]
image::new_host_2.png[]

Für die Konfiguration der _IP-Adresse_ haben Sie vier Möglichkeiten:

[cols="5,50,~"]
|===
|Möglichkeit |Vorgehen |DNS passiert 

|1 |Sie geben _keine_ IP-Adresse an. Der Hostname muss per DNS auflösbar sein. |bei [.guihint]#Activate Changes#
|2 |Sie geben eine Adresse ein -- in der üblichen Punkt-Notation. |nie
|3 |Sie geben anstelle einer IP-Adresse einen alternativen       Hostnamen ein, welcher per DNS auflösbar ist. |beim Ausführen der Checks
|4 |Über den link:wato_rules.html[Regelsatz] [.guihint]#Hosts with dynamic DNS lookup during monitoring# bestimmen Sie       Hosts für ein dynamisches DNS. Das Resultat ist analog zu 3, nur dass für die DNS-Anfrage       jetzt das Feld _Hostname_ verwendet wird. |beim Ausführen der Checks
|===


Bei der Methode _Hostname_ verwendet {CMK} eine Cache-Datei, um
wiederholte DNS-Anfragen während des [.guihint]#Activate Changes# zu vermeiden. Dieser Cache
ist sehr wichtig für die Beschleunigung des Vorgangs. Außerdem sorgt
er dafür, dass Sie eine geänderte Konfiguration auch dann aktivieren
können, wenn das DNS einmal nicht funktioniert.

Der Haken ist, dass {CMK} die Änderung einer IP-Adresse im DNS
nicht automatisch mitbekommt. Deswegen gibt es in den Hostdetails
den Knopf icon:button_update_dns_cache[], welcher den kompletten
DNS-Cache löscht und beim nächsten [.guihint]#Activate Changes# eine neue
Auflösung erzwingt. Diese Datei liegt übrigens in Ihrer Instanz unter
`~/var/check_mk/ipaddresses.cache`. Das Löschen dieser Datei hat
den gleichen Effekt wie der besagte Knopf.

{CMK} unterstützt übrigens auch Monitoring via *IPv6* -- auch im
Dualstack. Einzelheiten erklärt ein link:ipv6.html[eigener Artikel.]

== Data Sources und Custom Attributes

Die letzten wichtigen Einstellungen finden Sie in den Kästen
[.guihint]#Data Sources# und [.guihint]#Custom Attributes.# Die hier
angezeigten Attribute können Sie beliebig erweitern und dazu verwenden,
um über link:wato_rules.html[Regeln] sehr effizient alle Parameter von Hosts und
Services zu konfigurieren. [.guihint]#Criticality# und [.guihint]#Network Segment# sind lediglich
Beispiele.

Wichtiger ist die Angabe einer Datenquelle unter [.guihint]#Data Sources,# da diese bestimmt
wie der Host seine Daten an das Monitoring übermittelt.

[{image-border}]
image::new_host_3.png[]

Folgende link:wato_monitoringagents.html[Datenquellen] sind möglich:

[cols=2]
|===

|[.guihint]#Normal Checkmk agent# |Der Host soll über den   link:wato_monitoringagents.html[{CMK}-Agenten] überwacht werden   (welcher natürlich dazu installiert sein muss).   Auch im Falle von _Spezial-Agenten_, wie z.B. beim ESX-Monitoring,   wählen Sie diese Einstellung.
|[.guihint]#SNMP# |Der Host soll über link:snmp.html[SNMP] überwacht werden.    Diese Auswahl lässt in den [.guihint]#Basic settings# das Feld [.guihint]#SNMP Community#    auftauchen, mit der Sie die SNMP-Community festlegen können. Da diese    meist für viele Host gleich ist, empfiehlt sich aber eher, das im Ordner    zu hinterlegen. Wenn Sie gar nichts spezifizieren, wird automatisch `public`    angenommen.
|[.guihint]#Piggyback# |Es werden link:piggyback.html[Piggyback-Daten] anderer Hosts verwendet.
|[.guihint]#No Agent# |Solche Host werden agentenlos und nur mit link:active_checks.html[aktiven Checks] überwacht. Regeln      dafür finden Sie in WATO unter [.guihint]#Host & Service Parameters => Active checks#. Wenn      Sie nicht mindestens einen aktiven Check definieren, so erzeugt {CMK} automatisch      einen PING-Service.

      Die Einstellung [.guihint]#No Agent# finden Sie als Option unter [.guihint]#Check_MK Agent.#
|===



[#labels]
== Labels

Ab Version VERSION[1.6.0] von {CMK} gibt es das neue Konzept der link:labels.html[Labels].
Ein Host kann beliebig viele Labels haben. Labels sind ähnlich wie
Hostmerkmale (Tags), müssen aber im Gegensatz zu diesen nicht vordefinert
werden, sonden Sie können Sie frei vergeben.

Geben Sie für den Hosts Labels ein, in dem Sie mit der Maus auf [.guihint]#Add some Label#
klicken. Drücken Sie nach jedem Label *Enter*, um dieses
abzuschließen! Mit den Kreuzchen können Sie Labels entfernen.

image::wato_host_labels_entry.png[]

Wenn Sie für ein Label eigentlich keinen Wert brauchen, sondern nur wissen
wollen, ob an dem Host ein bestimmtes Label hängt oder nicht, vergeben Sie
z.B.: einfach `yes` als Wert (`vm:yes`). Falls Sie dieses
Schema konsequent einhalten, haben Sie es später leichter, für solche
Labels Bedingungen zu definieren.

Übrigens können Labels auch automatisch an Hosts gehängt werden: zum einen
durch externe Konnektoren, welche automatisch Hosts anlegen (z.B. automatisch
erkannte Hosts in Cloud-Umgebungen), zum anderen durch Regeln.

== Speichern und weiter

Beim Neuanlegen oder Klonen eines Hosts ist der nächste sinnvolle Schritt immer
[.guihint]#Save & go to Services#. Damit gelangen Sie in die automatische Serviceerkennung,
der wir uns im nächsten Abschnitt widmen wollen. [.guihint]#Save & Test# bringt Sie in den
Diagnosemodus, mit dem Sie erstmal testen können, ob Sie mit den gemachten Einstellungen
überhaupt Daten vom Agenten bekommen. Einzelheiten zum Diagnosemodus finden Sie im
link:wato_monitoringagents.html#diagnosticpage[Artikel über die Agenten].
