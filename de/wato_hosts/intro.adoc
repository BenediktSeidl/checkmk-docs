= Einleitung

Die wichtigste Aufgabe beim Einrichten des Monitorings ist sicherlich das
Verwalten der zu überwachenden Systeme -- der _Hosts_. Dabei geht es nicht
nur darum, dass diese mit den richtigen Stammdaten (z.B. Hostname, IP-Adresse)
eingetragen sind. Auch Einstellungen für das Monitoring (z.B. Alarmierung,
Schwellwerte, usw.) wollen gepflegt werden.

{CMK} wurde von an Anfang für Umgebungen mit sehr vielen Hosts entworfen. Um
hier die Konfiguration für den Nutzer beherrschbar zu machen, verfolgt
{CMK} bei der Konfiguration einen anderen Ansatz als alle anderen Systeme,
die aus dem Ökosystem von Nagios heraus enstanden sind. Die wichtigsten
Prinzipien sind:

* Eine Hierarchie von Ordnern, in denen Hosts abgelegt werden
* Hostmerkmale (Hosttags) und eine darauf basierende link:wato_rules.html[regelbasierte] Konfiguration
* link:wato_services.html[Automatische Erkennung] der zu überwachenden Services


[#folder]
== Ordner und ihre Hierarchie

Jeder, der mit Computern arbeitet, kennt das Prinzip von Dateien und Ordnern.
WATO verwendet ein analoges Prinzip für die Verwaltung der Hosts, welche
quasi die Rolle der Dateien übernehmen. Da Ordner selbst in Ordnern enthalten
sein können, ergibt sich eine Baumstruktur. Dabei sind drei Kriterien für
den Aufbau des Host-Baums verbreitet:

* *Standort* (z.B. München versus Shanghai)
* *Host-Typ* (z.B. Switch versus Loadbalancer)
* *Organisationsstruktur* (z.B. Datenbankgruppe versus Netzwerker)

Natürlich können Sie das auch mischen, also z.B. in der ersten Ebene
des Baums Aufteilung nach Standort, in der zweiten dann nach Host-Typ.

Wenn Sie einfache Dinge lieben, sollten Sie die eigentlichen Hosts
nur in die _„Blätter“_ des Baums packen (auch wenn {CMK} Hosts
in mittleren Ordnern erlaubt). Folgendes Beispiel zeigt eine einfache
Baumstruktur nach Host-Typ: Die Hosts _A_, _B_ und _C_
sind im Ordner _Server_ und _D_, _E_ und _F_ in _Network_:

image::wato_folders_step_2.png[width=430]


[#inheritance]
== Vererbung von Attributen

Wenn Sie den Baum geschickt aufbauen, können Sie ihn nutzen,
um sinnvoll _Attribute zu vererben_. Das ist vor allem bei solchen
Attributen nützlich, die bei großen Gruppen von Hosts gleich sind, wie
z.B. die SNMP-Community oder _Hostmerkmale_ wie der [.guihint]#Agent Type#,
mit dem Sie festlegen, ob der Host per SNMP oder per {CMK}-Agent
überwacht werden soll.

Folgendes Beispiel zeigt die Vererbung der Merkmale [.guihint]#Agent Type# mit
den Ausprägungen `cmk-agent` und `snmp-only` sowie des
Merkmals [.guihint]#Criticality# mit den Ausprägungen `prod` und `test`:

image::wato_folders_step_4.png[width=500]

Weiter unten im Baum definierte Attribute haben immer Vorrang. Direkt beim
Host festgelegte Werte überschreiben also alles, was von den Ordnern kommt.
In obigem Beispiel ergeben sich so für den Host _A_ die Merkmale
`prod` und `cmk-agent`, für _D_ `prod` und
`snmp-only` und für den Host _F_ wegen des expliziten Attributs
die Werte `test` und `snmp-only`.

Ein großer Vorteil dieses Schemas gegenüber dem weit verbreiteten
_Copy & Paste_-Ansatz von datenbankorientierten Konfigurationsystemen:
Sie können Attribute auch für solche Hosts festlegen, die erst *in Zukunft*
hinzukommen werden. Das macht die Arbeit für Sie (oder Ihre Kollegen)
leichter: Einfach den neuen Host in den richtigen Ordner werfen und alle
Einstellungen stimmen automatisch!


== Berechtigungen

Ein weiterer Zweck der Ordner ist die Vergabe von _Berechtigungen für
das Anlegen und Bearbeiten von Hosts_. {CMK} unterscheidet dabei
die Rechte in WATO von den Kontaktzuordnungen im Monitoring. Denn es
ist nicht immer gesagt, dass die gleichen Personen, die das Recht haben,
einen Host anzulegen, auch diejenigen sind, die im operativen Monitoring
für diesen Host verantwortlich sind. Die Berechtigungen werden in einem
link:wato_user.html#wato_permissions[eigenen Artikel erläutert.]

Das Anlegen neuer Ordner erledigen Sie über icon:icon_newfolder[]. Die
Optionen sind dieselben wie beim Anlegen neuer Hosts, was wir im Folgenden
detailliert erläutern.