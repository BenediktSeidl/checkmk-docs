[#parents]
= Parents anlegen

== Parents manuell anlegen

Wie link:monitoring_basics.html#parents[Parents] funktionieren, haben Sie bereits
gelernt und auch was es mit Zuständen von link:monitoring_basics.html#hosts[Hosts]
und link:monitoring_basics.html#notifications[Alarmierungen] auf sich hat, ist bekannt. Aber wie
legt man Parents überhaupt an? Die Antwort ist typisch {CMK}: Es gibt
unterschiedliche Vorgehensweisen: Manuell, per Scan oder über die Web-API.

Einen Parent für einen einzelnen Host legen Sie so fest: Öffnen Sie die
Eigenschaften des gewünschten Hosts über [.guihint]#WATO => Hosts#. Im Bereich
[.guihint]#Basic Settings# tragen Sie den Parent über seinen Namen oder die IP-Adresse
ein. Sobald ein Parent angegeben wird, erscheint ein weiteres Eingabefeld
für einen zusätzlichen Parent.

*Wichtig*: Es werden immer nur direkte Parent-Hosts angegeben.

image::parents_host_config.png[]

Analog lassen sich Parents auch in den Eigenschaften von Ordnern festlegen
und auf die beinhalteten Hosts vererben. Wie das geht, haben Sie bereits im
Abschnitt zu der link:wato_hosts.html#inheritance[Host-Verwaltung] gelesen.


== Parents per Scan anlegen lassen

Wenn Sie Ihr Monitoring frisch aufsetzen und von vorne herein sauber mit
Ordnern und Parents planen, werden Sie mit der Parent-Vererbung über Ordner
vermutlich gut zurecht kommen. Sie können Parents aber auch über einen
Scan automatisch einrichten lassen. Den [.guihint]#Parent scan# finden Sie unter
[.guihint]#WATO => Hosts# in jedem einzelnen Ordner.

Der Scan sucht über das IP-Protokoll auf dem Network Layer des OSI-Modells
(Schicht 3) via _traceroute_ nach dem letzten Gateway vor einem
Host. Wird ein solches Gateway gefunden und gehört dessen Adresse zu
einem Ihrer überwachten Hosts, so wird dieser als Parent gesetzt. Bekommt
traceroute von den Hops vor dem anvisierten Host keine Informationen, so
wird der letzte erfolgreiche Hop verwendet.

Wird jedoch kein Gateway mit einer überwachten IP-Adresse gefunden, legt
{CMK} per Default einen künstlichen Ping-only-Host an, standardmäßig
im Ordner [.guihint]#Parent#, der gleich mit angelegt wird.

Diese Standardeinstellung kann auch zu unerwünschten Ergebnissen
führen: Nehmen Sie ein typisches, kleines Netzwerk mit dem Adressbereich
_192.168.178.0/24._ Wird in dieses Monitoring nun ein Host mit einer
Adresse aus einem anderen Adressbereich aufgenommen, der nicht angepingt
werden kann, so versucht der Scan den Weg über den Router -- und findet dort
nur den Knotenpunkt des Netz-Providers. Und so könnte dann zum Beispiel
ein Telekom-Server aus dem WAN-Bereich als Parent für diesen Host gesetzt
werden. Natürlich können Sie diese Option deaktivieren.

Wenn Sie einen Ordner mit neuen Hosts auf Parents scannen wollen, gehen Sie
wie folgt vor:

Navigieren Sie zunächst in den gewünschten Ordner und klicken Sie auf
icon:icon_parentscan[] [.guihint]#Parent scan#.

[{image-border}]
image::parents_folder_scan3.png[]

Anschließend öffnet sich die Scan-Konfiguration. Um alle Hosts in allen
Unterordnern komplett neu einzuscannen, unabhängig von eventuell manuell
gesetzten Parents, wählen Sie unter [.guihint]#Selection# die Optionen [.guihint]#Include all subfolders#
und [.guihint]#Scan all hosts#. Im Bereich [.guihint]#Performance# können
Sie die Scan-Dauer anpassen, die bei vielen Hosts recht lang ausfallen kann.

Unter [.guihint]#Creation of gateway hosts# bestimmen Sie, ob, wie und unter welchem
Alias neu erzeugte Parent-Hosts erzeugt werden. Deaktivieren Sie die Funktion,
wenn Sie Parents auf überwachte Hosts beschränken wollen.

image::parents_configuration.png[]

Starten Sie nun den Scan. Die Ausgabe des Scans können Sie live
mitverfolgen. Nach Abschluss müssen Sie die Änderungen wie üblich über
[.guihint]#Activate Changes# aktivieren. Anschließend sehen Sie die
konfigurierten Parents sowie gegebenenfalls einen neuen Ordner [.guihint]#Parents#
unter [.guihint]#WATO => Hosts#.

[{image-border}]
image::parents_host_list.png[]

Damit ist der Scan abgeschlossen.

Nach einem durchgeführten Scan werden die Parent-Child-Beziehungen automatisch
als Topologie-Karte visualisiert, die Sie über [.guihint]#Views => Network Topology#
aufrufen können.

[{image-border}]
image::monitoring_parents.png[]

*Tipp:* Wenn die Ergebnisse des Scans an einigen Stellen nicht plausibel
erscheinen, ist ein manueller traceroute-Aufruf bisweilen hilfreich, um die
einzelnen Hops nachzuvollziehen.

Sie können übrigens auch, statt eines ganzen Ordners, nur eine Auswahl von
Hosts scannen lassen: Aktivieren Sie zunächst über icon:icon_checkbox[]
die Checkboxen, markieren Sie die gewünschten Hosts und starten Sie
anschließend die Gruppenaktion [.guihint]#Parentscan#.

[{image-border}]
image::parents_scan_selection.png[]


== Parents ohne WATO anlegen

Für versierte Nutzer gibt es die Möglichkeit, Parents über die
link:web_api_references.html[Web-API] zu konfigurieren.