= Zeitperioden (Time Periods)
:revdate: 2016-10-24
[.seealso][#wato] [#basics_downtimes] [#wato_rules]MT:Dinge auf bestimmte Tageszeiten beschränken
MD:Mit Zeitperioden können gängige Einschränkungen, wie Arbeits- oder Servicezeiten und anderes abgebildet werden. Wie das funktioniert, erfahren Sie hier.

== Einleitung

image::bilder/icon_timeperiods.png[align=left,width=107]

Um das Monitoring an die Arbeitsrhythmen des Menschen anzupassen und so
z.B. sinnlose Alarmierungen zu vermeiden, bietet (CMK) die Möglichkeit,
verschiedene Einstellungen von Tageszeit oder Wochentag abhängig zu machen.

Damit die Konfiguration einfach und übersichtlich ist, geschieht das in
zwei Schritten. Zunächst definieren Sie [.guihints]#Zeitperioden}}.# Eine solche kann
z.B. „Arbeitszeit“ heißen und die Tage Montag bis Freitag von jeweils
8:00 bis 17:00 Uhr enthalten. Jede der Zeitperioden ist also zu einem bestimmten
Zeitpunkt entweder aktiv oder inaktiv.

Anschließend können Sie diese Zeitperioden in der Konfiguration verwenden.
Sie kommen unter anderem in den folgenden Regeln zum Einsatz. All diese Regeln
haben gemeinsam, dass die Angabe der Zeitperiode optional ist und den
zeitlichen Wirkungsbereich der Regeln einschränkt:

[cols=, ]
|===


<td style="width:30%">{{Notification period for ...}}
|Einschränkung der Zeiten, in denen für einen Host oder Service eine [notifications|Alarmierung]
erzeugt wird. Außerhalb der definierten Zeiten werden keine Alarme erzeugt und die Kette der
Alarmierungsregeln kommt gar nicht erst zum Einsatz.



|Alarmierungsregeln
|Auch in jeder einzelnen [notifications#rules|Alarmierungsregel] können Sie eine bestimmte Zeitperiode zur
Bedingung machen. So können Sie z.B. den Alarmierungsweg (Email oder SMS) von der Tageszeit abhängig machen.


|{{Check period for ...}}
|Damit können Sie die Ausführung von Checks zeitlich einschränken. Außerhalb der definierten
Zeitperiode werden die Checks nicht durchgeführt und der Status bleibt auf dem Zustand der letzten
Checkausführung. Bitte verwenden Sie dies mit Vorsicht. Ein Service kann als (OK) angezeigt werden,
obwohl er schon seit Stunden eigentlich kritisch ist.


|{{Service period for ...}}
|Mithilfe der Serviceperiode können Sie die prozentualen Verfügbarkeiten von Diensten innerhalb
von bestimmten Zeiten berechnen.


|Event Console
|Die Gültigkeit von Regeln in der [ec|Event Console] kann abhängig von einer Zeitperiode sein. Damit
können Sie z.B. bestimmte Logmeldungen zu manchen Zeiten als unproblematisch deklarieren.


|Alerthandlerregeln
|Auch die Ausführung von [alert_handlers|Alerthandlerregeln] kann durch Zeitperioden gesteuert werden.


|Schwellwerte
|Zukünftige Versionen von (CMK) sind eventuell in der Lage, auch Schwellwerte von Checks
zeitgesteuert zu machen. Damit könnten Sie dann z.B. die Schwellwerte für die CPU-Auslastung
eines Servers tagsüber anders einstellen als in der Nacht.

|===


== Zeitperioden konfigurieren

=== Wochentage

Zeitperioden verwalten Sie mit dem [wato|WATO]-Modul ICON[icon_timeperiods.png]
[.guihints]#Timeperiods}}.# Die implizit immer vorhandene Period [.guihints]#Always# wird dabei
in der Liste nicht angezeigt und ist daher auch nicht änder- oder löschbar.

Wie üblich in WATO, hat die Definition der Zeitperiode eine interne ID
und einen Anzeigenamen ({{Alias}}).# Nur letzterer kann später geändert
werden und wird in Auswahllisten etc. angezeigt. Für jeden Wochentag
können Sie drei Zeiträume angeben, in denen die Zeitperiode _aktiv_ ist.
Verwenden Sie dabei eine Notation im 24-Stunden-Format.

Wichtig: Um den kompletten Tag bis Mitternacht einzuschließen, schreiben
Sie `00:00` - `24:00`, auch wenn die Uhrzeit 24:00 ja eigentlich
nicht existiert. Wenn Sie einen Bereich _ausschließen_ möchten, so geben
Sie einfach die Zeit davor und danach an, also z.B. `00:00` - `8:00` und
`17:00` - `24:00`. Tage, an denen die Zeitperiode nie aktiv sein
soll, lassen Sie einfach leer.

image::bilder/create_timeperiod.jpg[]


=== Einzelne Kalendertage

Mithilfe von [.guihints]#Add Exception# können Sie einzelne Kalendertage im
„Internationalen Datumsformat“ angeben, also in der Form YYYY-MM-DD,
z.B. `2017-12-25`. An diesen Tagen gelten dann _nur_ die dort
angegebenen Tageszeiten:

image::bilder/timeperiods_exception.png[]

Auf diese Art können Sie sich z.B. einen individuellen Kalender von
Feiertagen zusammenstellen. Dabei sind die Zeilen [.guihints]#Monday# bis [.guihints]#Sunday}}# 
leer und bei den aufgelisteten Feiertagen geben Sie jeweils `00:00` -
`24:00` an.


=== Zeitperioden aus anderen ausschließen

So einen Feiertagskalender können Sie dann aus einer anderen Zeitperiode
_ausklammern_. Der häufigste Fall ist das Ausklammern der Feiertage aus
einer Zeitperiode für die normalen Büroarbeitszeiten. Dazu kreuzen
Sie einfach Ihren Feiertagskalender bei [.guihints]#Exclude# an:

image::bilder/timeperiods_holidays.jpg[]


=== Kalender aus dem Internet importieren

Gerade für Ferien- und Feiertagskalender gibt es den praktischen Import von
Kalenderdateien im iCal-Format. Solche Dateien sind im Internet leicht
zu finden und ersparen Ihnen das mühsame Eingeben von Feiertagen von Hand.
Feiertage aller deutschen Bundesländer finden Sie z.B. unter
<a href="https://www.ferienwiki.de/exports/de">www.ferienwiki.de/exports/de</a>.

Importieren so eine Datei mit dem Knopf ICON[button_import_ical.png] und
legen Sie in der Maske fest, für wie viele Jahre in die Zukunft periodische
Feiertage in die Zeitperiode eingetragen werden sollen:

image::bilder/timeperiods_ical.png[align=center,width=500]

Sie erhalten dann eine vorausgefüllte Zeitperiodendefinition, bei der Sie nur noch
ID und Name festlegen müssen und können diese dann wie oben beschrieben aus
anderen Zeitperioden ausschließen.
